// Copyright 2000-2024 JetBrains s.r.o. and contributors. Use of this source code is governed by the Apache 2.0 license.

class GradleDebuggerUtil {

  static Boolean isDebuggerEnabled() {
    String enabled = requireNonNullElse(System.getenv("DEBUGGER_ENABLED"), "false")
    return Boolean.parseBoolean(enabled)
  }

  static String getDebuggerId() {
    return System.getenv("DEBUGGER_ID")
  }

  static String getProcessParameters() {
    return System.getenv("PROCESS_PARAMETERS")
  }

  static List<String> getProcessOptions() {
    String envValue = requireNonNullElse(System.getenv("PROCESS_OPTIONS"), "")
    if (isBlank(envValue)) {
      return Collections.emptyList()
    }
    List<String> options = new ArrayList<>()
    for (final def option in envValue.split(", ")) {
      if (!isBlank(option)) {
        options.add(option.trim())
      }
    }
    return options
  }

  private static <T> T requireNonNullElse(T object, T fallback) {
    return (object != null) ? object : Objects.requireNonNull(fallback, "The fallback value must not be null!")
  }

  private static boolean isBlank(String value) {
    return value == null || value.trim().isEmpty()
  }
}
